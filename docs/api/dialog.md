<a name="Dialog"></a>

## Dialog
**Extends:** <code>EventEmitter</code>  
Class representing a SIP Dialog.

Note that instances of this class are not created directly by your code;
rather they are returned from the [Srf#createUAC](Srf#createUAC), [Srf#createUAC](Srf#createUAC), and [Srf#createB2BUA](Srf#createB2BUA)


* [Dialog](#Dialog)

    * [new Dialog(srf, type, opts)](#new_Dialog_new)

    * [.sip](#Dialog+sip)

    * [.local](#Dialog+local)

    * [.remote](#Dialog+remote)

    * [.destroy([opts], [callback])](#Dialog+destroy)

    * [.modify(sdp, [callback])](#Dialog+modify)

    * [.request([opts], [callback])](#Dialog+request)

    * ["destroy" (msg)](#Dialog+event_destroy)

    * ["modify" (req, res)](#Dialog+event_modify)

    * ["refresh" (msg)](#Dialog+event_refresh)

    * ["info" (req, res)](#Dialog+event_info)

    * ["notify" (req, res)](#Dialog+event_notify)

    * ["options" (req, res)](#Dialog+event_options)

    * ["update" (req, res)](#Dialog+event_update)

    * ["refer" (req, res)](#Dialog+event_refer)

    * ["message" (req, res)](#Dialog+event_message)


<a name="new_Dialog_new"></a>

### new Dialog(srf, type, opts)

| Param | Type | Description |
| --- | --- | --- |
| srf | <code>Srf</code> | Srf instance that created this dialog |
| type | <code>string</code> | type of SIP dialog: 'uac', or 'uas' |
| opts | <code>Dialog~Options</code> |  |

Constructor that is called internally by Srf when generating a Dialog instance.

<a name="Dialog+sip"></a>

### *dialog*.sip
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| callId | <code>String</code> | SIP Call-ID |
| localTag | <code>String</code> | tag generated by local side of the Dialog |
| remoteTag | <code>String</code> | tag generated by the remote side of the Dialog |

sip properties that uniquely identify this Dialog

<a name="Dialog+local"></a>

### *dialog*.local
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| uri | <code>String</code> | sip |
| sdp | <code>String</code> | session description protocol |

local side of the Dialog

<a name="Dialog+remote"></a>

### *dialog*.remote
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| uri | <code>String</code> | sip |
| sdp | <code>String</code> | session description protocol |

remote side of the Dialog

<a name="Dialog+destroy"></a>

### *dialog*.destroy([opts], [callback])

| Param | Type | Description |
| --- | --- | --- |
| [opts] | <code>Object</code> | configuration options |
| [opts.headers] | <code>Object</code> | SIP headers to add to the outgoing BYE or NOTIFY |
| [callback] | <code>function</code> | if provided, callback with signature <code>(err, msg)</code> that provides the BYE or NOTIFY message that was sent to terminate the dialog |

destroy the sip dialog by generating a BYE request (in the case of INVITE dialog),
or NOTIFY (in the case of SUBSCRIBE)

**Returns**: <code>Promise</code> &#124; <code>[Dialog](#Dialog)</code> - if no callback is supplied, otherwise a reference to the Dialog  
<a name="Dialog+modify"></a>

### *dialog*.modify(sdp, [callback])

| Param | Type | Description |
| --- | --- | --- |
| sdp | <code>string</code> | 'hold', 'unhold', or a session description protocol |
| [callback] | <code>function</code> | callback invoked with signature <code>(err)</code> when operation has completed |

modify the dialog session by changing attributes of the media connection

**Returns**: <code>Promise</code> &#124; <code>[Dialog](#Dialog)</code> - if no callback is supplied, otherwise the function returns a reference to the Dialog  
<a name="Dialog+request"></a>

### *dialog*.request([opts], [callback])

| Param | Type | Description |
| --- | --- | --- |
| [opts] | <code>Object</code> |  |
| opts.method | <code>string</code> | SIP method to use for the request |
| [opts.headers] | <code>Object</code> | SIP headers to apply to the request |
| [opts.body] | <code>string</code> | body of the SIP request |
| [callback] | <code>function</code> | callback invoked with signature <code>(err, req)</code> when operation has completed |

send a request within a dialog.
Note that you may also call <code>request.info(..)</code> as a shortcut
to send an INFO message, <code>request.notify(..)</code>
to send a NOTIFY, etc..

**Returns**: <code>Promise</code> &#124; <code>[Dialog](#Dialog)</code> - if no callback is supplied a Promise that resolves to the response received,
otherwise the function returns a reference to the Dialog  
<a name="Dialog+event_destroy"></a>

### "destroy" (msg)

| Param | Type | Description |
| --- | --- | --- |
| msg | <code>Object</code> | incoming BYE request message |

a <code>destroy</code> event is triggered when the Dialog is torn down from the far end

<a name="Dialog+event_modify"></a>

### "modify" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

a <code>modify</code> event is triggered when the far end modifies the session by sending a re-INVITE.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK with the current local SDP
will be automatically generated.

<a name="Dialog+event_refresh"></a>

### "refresh" (msg)

| Param | Type | Description |
| --- | --- | --- |
| msg | <code>Object</code> | incoming re-INVITE request message |

a <code>refresh</code> event is triggered when the far end sends a session refresh.
There is no need for the application to respond to this event; this is purely
a notification.

<a name="Dialog+event_info"></a>

### "info" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

an <code>info</code> event is triggered when the far end sends an INFO message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_notify"></a>

### "notify" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

a <code>notify</code> event is triggered when the far end sends a NOTIFY message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_options"></a>

### "options" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

an <code>options</code> event is triggered when the far end sends an OPTIONS message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_update"></a>

### "update" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

an <code>update</code> event is triggered when the far end sends an UPDATE message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_refer"></a>

### "refer" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

a <code>refer</code> event is triggered when the far end sends a REFER message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_message"></a>

### "message" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

a <code>message</code> event is triggered when the far end sends a MESSAGE message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

