## Dialog
**Extends:** <code>EventEmitter</code>  
Class representing a SIP Dialog.

Note that instances of this class are not created directly by your code;
rather they are returned from the [Srf#createUAC](Srf#createUAC), [Srf#createUAC](Srf#createUAC), and [Srf#createB2BUA](Srf#createB2BUA)


* [Dialog](#Dialog)

    * [new Dialog(srf, type, opts)](#new_Dialog_new)

    * _instance_
        * [.sip](#Dialog+sip)

        * [.local](#Dialog+local)

        * [.remote](#Dialog+remote)

        * [.destroy([callback])](#Dialog+destroy)

        * [.modify(sdp, [callback])](#Dialog+modify)

        * [.request(opts, [callback])](#Dialog+request)

        * ["destroy" (msg)](#Dialog+event_destroy)

        * ["modify" (req, res)](#Dialog+event_modify)

        * ["refresh" (msg)](#Dialog+event_refresh)

        * ["info" (req, res)](#Dialog+event_info)

        * ["notify" (req, res)](#Dialog+event_notify)

        * ["update" (req, res)](#Dialog+event_update)

        * ["refer" (req, res)](#Dialog+event_refer)

    * _inner_
        * [~Options](#Dialog..Options)

        * [~requestOptions](#Dialog..requestOptions)

        * [~requestCallback](#Dialog..requestCallback)

        * [~requestCallback](#Dialog..requestCallback)

        * [~modifySessionCallback](#Dialog..modifySessionCallback)

        * [~SipInfo](#Dialog..SipInfo)

        * [~SipEndpointInfo](#Dialog..SipEndpointInfo)


<a name="new_Dialog_new"></a>

### new Dialog(srf, type, opts)

| Param | Type | Description |
| --- | --- | --- |
| srf | <code>Srf</code> | Srf instance that created this dialog |
| type | <code>string</code> | type of SIP dialog: 'uac', or 'uas' |
| opts | <code>[Options](#Dialog..Options)</code> |  |

Constructor that is called internally by Srf when generating a Dialog instance.

<a name="Dialog+sip"></a>

### *dialog*.sip
sip properties that uniquely identify this Dialog

<a name="Dialog+local"></a>

### *dialog*.local
local side of the Dialog

<a name="Dialog+remote"></a>

### *dialog*.remote
local side of the Dialog

<a name="Dialog+destroy"></a>

### *dialog*.destroy([callback])

| Param | Type | Description |
| --- | --- | --- |
| [callback] | <code>[requestCallback](#Dialog..requestCallback)</code> | callback that returns the generated BYE or NOTIFY message |

destroy the sip dialog by generating a BYE request (in the case of INVITE dialog),
or NOTIFY (in the case of SUBSCRIBE)

**Returns**: <code>Promise</code> - if no callback is supplied, otherwise the function returns a reference to the Dialog  
<a name="Dialog+modify"></a>

### *dialog*.modify(sdp, [callback])

| Param | Type | Description |
| --- | --- | --- |
| sdp | <code>string</code> | 'hold', 'unhold', or a session description protocol |
| [callback] | <code>[modifySessionCallback](#Dialog..modifySessionCallback)</code> | callback invoked when operation has completed |

modify the dialog session by changing attributes of the media connection

**Returns**: <code>Promise</code> - if no callback is supplied, otherwise the function returns a reference to the Dialog  
<a name="Dialog+request"></a>

### *dialog*.request(opts, [callback])

| Param | Type | Description |
| --- | --- | --- |
| opts | <code>[requestOptions](#Dialog..requestOptions)</code> | configuration options |
| [callback] | <code>[requestCallback](#Dialog..requestCallback)</code> | callback invoked when operation has completed |

send a request within a dialog.
Note that you may also call <code>request.info(..)</code> as a shortcut
to send an INFO message, <code>request.notify(..)</code>
to send a NOTIFY, etc..

**Returns**: <code>Promise</code> - if no callback is supplied a Promise that resolves to the response received,
otherwise the function returns a reference to the Dialog  
<a name="Dialog+event_destroy"></a>

### "destroy" (msg)

| Param | Type | Description |
| --- | --- | --- |
| msg | <code>Object</code> | incoming BYE request message |

a <code>destroy</code> event is triggered when the Dialog is torn down from the far end

<a name="Dialog+event_modify"></a>

### "modify" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

a <code>modify</code> event is triggered when the far end modifies the session by sending a re-INVITE.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK with the current local SDP
will be automatically generated.

<a name="Dialog+event_refresh"></a>

### "refresh" (msg)

| Param | Type | Description |
| --- | --- | --- |
| msg | <code>Object</code> | incoming re-INVITE request message |

a <code>refresh</code> event is triggered when the far end sends a session refresh.
There is no need for the application to respond to this event; this is purely
a notification.

<a name="Dialog+event_info"></a>

### "info" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

an <code>info</code> event is triggered when the far end sends an INFO message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_notify"></a>

### "notify" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

a <code>notify</code> event is triggered when the far end sends a NOTIFY message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_update"></a>

### "update" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

an <code>update</code> event is triggered when the far end sends an UPDATE message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog+event_refer"></a>

### "refer" (req, res)

| Param | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio request object |
| res | <code>Object</code> | drachtio response object |

a <code>refer</code> event is triggered when the far end sends a REFER message.
When an application adds a handler for this event it must generate
the SIP response by calling <code>res.send</code> on the provided drachtio response object.
When no handler is found for this event a 200 OK will be automatically generated.

<a name="Dialog..Options"></a>

### *Dialog*~Options
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| req | <code>Object</code> | drachtio Request (only provided when creating a 'uas' dialogs) |
| res | <code>Object</code> | drachtio Response |
| sent | <code>Object</code> | uas only: actual Response sent when confirming the dialog |

Arguments provided to Dialog constructor.

<a name="Dialog..requestOptions"></a>

### *Dialog*~requestOptions
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| method | <code>String</code> | SIP method to use for the request |
| headers | <code>Object</code> | SIP headers to apply to the request |
| body | <code>String</code> | body of the SIP request |

<a name="Dialog..requestCallback"></a>

### *Dialog*~requestCallback

| Param | Type | Description |
| --- | --- | --- |
| err | <code>Error</code> | error, if any |
| response | <code>Response</code> | response received from the far end |

This callback provides the response to a sip request sent within the dialog.

<a name="Dialog..requestCallback"></a>

### *Dialog*~requestCallback

| Param | Type | Description |
| --- | --- | --- |
| err | <code>Error</code> | error returned on non-success |
| req | <code>Request</code> | Request that was generated |

This callback provides the SIP request that was generated

<a name="Dialog..modifySessionCallback"></a>

### *Dialog*~modifySessionCallback

| Param | Type | Description |
| --- | --- | --- |
| err | <code>Error</code> | non-success sip response code received from far end |

This callback provides the response a modifySession request.

<a name="Dialog..SipInfo"></a>

### *Dialog*~SipInfo
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| callId | <code>String</code> | SIP Call-ID |
| localTag | <code>String</code> | tag generated by local side of the Dialog |
| remoteTag | <code>String</code> | tag generated by the remote side of the Dialog |

SIP Dialog identifiers

<a name="Dialog..SipEndpointInfo"></a>

### *Dialog*~SipEndpointInfo
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| uri | <code>String</code> | sip |
| sdp | <code>String</code> | session description protocol |

SIP Endpoint identifiers
